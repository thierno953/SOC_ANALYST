# Identifying Known Malware Signature

#### Objectif

- Détecter des **signatures connues de malwares** dans des fichiers suspects à l’aide d’une règle **YARA**. Cela permet d’automatiser la détection de chaînes de texte ou de séquences hexadécimales souvent retrouvées dans des malwares.

#### Étapes :

**Écriture de la règle YARA**

- Crée un fichier YARA contenant la règle de détection :

```sh
nano task1.yar
```

- Contenu du fichier task1.yar :

```sh
rule known_Malware_Signature {
    meta:
        description = "Detects known malware signatures"
        author = "Your Name"
        date = "2025-01-05"
        severity = "high"

    strings:
        $a = {6A 40 68 00 30 00 00 6A 14 8D 91}     // Séquence hexadécimale
        $b = "You are hacked"                      // Message typique d'attaque

    condition:
        any of them
}
```

- Création d’un fichier suspect à analyser

```sh
nano file1.txt
```

- Contenu du fichier file1.txt :

```sh
--- BEGIN FILE HEADER ---
File ID: MAL-032021
Timestamp: 2025-01-12T08:24:10Z
Author: Unidentified
Description: This file contains confidential configuration info

--- SYSTEM CONFIGURATION ---
System ID: X59-12-ACF
Server IP: 192.168.45.132
Access Level: Restricted
Authorized Users: Admin, Root, ServiceAccount

#You are hacked
--- ENCRYPTED PAYLOAD START ---
Payload Version: 1.4.3
Signature: ZXcuMThyJHlMT2VfJlBFdjhyQl83Cg==

Embedded malicious sequence (hidden from logs):
6A 40 68 00 30 00 00 6A 14 8D 91

--- FILE CHECKSUM ---
Checksum (MD5): 5f4dcc3b5aa765d61d8327deb882cf99
Verification: Pending

--- ADDITIONAL DATA ---
Unused Flags: 0xFF01A9
Malware Status: Unverified
Signature Validation: Failed
```

- Exécution de YARA pour scanner le fichier

```sh
barry@Thierno:~$ yara -s task1.yar file1.txt
```
