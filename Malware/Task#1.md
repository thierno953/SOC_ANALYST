# Identifying Known Malware Signature

- Identifying known Malware Signature
- Purpose
- Yara rule
- Sample file

```sh
barry@Thierno:~$ nano task1.yar
```

```sh
rule known_Malware_Signature {
    strings:
        $a = "6A 40 68 00 30 00 00 6A 14 8D 91"  // Séquence hexadécimale
        $b = "You are hacked"                      // Chaîne de caractères
    condition:
        any of them     // La condition est remplie si l'une des chaînes est trouvée
        // all of them

}



# ----------------------


rule known_Malware_Signature {
    meta:
        description = "Detects known malware signatures"
        author = "Your Name"
        date = "2025-01-05"
        severity = "high"

    strings:
        $a = "6A 40 68 00 30 00 00 6A 14 8D 91"
        $b = "You are hacked"

    condition:
        any of them
}
```

```sh
barry@Thierno:~$ nano file1.txt
```

```sh
--- BEGIN FILE HEADER ---
File ID: MAL-032021
Timestamp: 2025-01-12T08:24:10Z
Author: Unidentified
Description: This file contains confidential configuration info

--- SYSTEM CONFIGURATION ---
System ID: X59-12-ACF
Server IP: 192.168.45.132
Access Level: Restricted
Authorized Users: Admin, Root, ServiceAccount

#You are hacked
--- ENCRYPTED PAYLOAD START ---
Payload Version: 1.4.3
Signature: ZXcuMThyJHlMT2VfJlBFdjhyQl83Cg==

Embedded malicious sequence (hidden from logs):
6A 40 68 00 30 00 00 6A 14 8D 91

--- FILE CHECKSUM ---
Checksum (MD5): 5f4dcc3b5aa765d61d8327deb882cf99
Verification: Pending

--- ADDITIONAL DATA ---
Unused Flags: 0xFF01A9
Malware Status: Unverified
Signature Validation: Failed
```

```sh
barry@Thierno:~$ yara -s task1.yar file1.txt
```
