# Static Malware Analysis

# 1. Determine File Type

https://mh-nexus.de/en/hxd/
https://www.eicar.org/
https://en.wikipedia.org/wiki/List_of_file_signatures

# 2. Obtain Md5 Hash

```sh
sudo -i
cd /home/kali/Downloads
ls
md5sum eicar_com.zip
sha1sum eicar_com.zip
```

# 3. Verify on VirusTotal

https://www.virustotal.com/gui/home/search

# 4. String Analysis

```sh
strings 9995d6c423d6c64f31f63b3c397dec75d2f48451eb91b5a6d64ab72d0f077428.exe
```

https://www.techspot.com/downloads/6350-pestudio.html

# YARA for Malware Detection

# Linux

```sh
sudo apt install yara
yara --version
yara --help
```

# Windows

https://github.com/virustotal/yara/releases

```sh
.\yara64.exe --help
```

```sh
rule ExampleRule
{
    strings:
       $example_string = "malicious"
    condition:
       $example_string
}
```

```sh
.\yara64.exe .\rule.yar .\sampl.txt
```

# ----------------------------------

rule Advanced_Ransomware_Detection {
    strings:
        $api_call1 = "CreateFileA"
        $api_call2 = "CryptEncrypt"
        $api_call3 = "CryptDestroyKey"
    condition:
        any of ($api_call*)
}


https://mh-nexus.de/en/hxd/
https://www.eicar.org/download-anti-malware-testfile/#top

https://hashtab.en.softonic.com/


https://www.virustotal.com/
https://bazaar.abuse.ch/
https://www.hybrid-analysis.com/

#=========Windows=================

md5sum eicar_com.zip
sha1sum eicar_com.zip


--------Linux----------

md5sum fichier_malveillant.exe
sha1sum fichier_malveillant.exe
sha256sum fichier_malveillant.exe

---------Windows---------

CertUtil -hashfile fichier_malveillant.exe MD5
CertUtil -hashfile fichier_malveillant.exe SHA1
CertUtil -hashfile fichier_malveillant.exe SHA256