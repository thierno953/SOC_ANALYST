# Malware

> Malware est un logiciel conçu intentionnellement pour endommager ou obtenir un accès non autorisé à un ordinateur, un serveur ou un réseau informatique.

`Malicious + Software = Malware`

> Les malwares sont écrits par des **hackers, cybercriminels** ou **auteurs de malwares**.

> Chaque jour, environ **300 000 nouveaux malwares** sont créés et distribués.

#### Intentions d’un malware

> Voler des informations sensibles

> Spamming

> Mettre hors service certains services

> Causer des fuites de données

> Installer d'autres applications malveillantes

> Chiffrer des fichiers (ransomware)

> Exécuter des attaques plus larges (DDoS, APT, etc.)

# YARA

> **YARA** est un outil puissant utilisé pour **détecter et classifier les malwares** en définissant des **règles de détection basées sur des motifs** (patterns).

> YARA signifie Yet Another Recursive Acronym.

> Il s’agit d’un **langage basé sur des règles**, utilisé pour identifier des échantillons de malwares à partir de motifs textuels, hexadécimaux ou réguliers.

#### Objectif

> Utilisé pour la **chasse aux menaces (threat hunting), l’analyse de malware**, et la **réponse aux incidents**.

> Il permet de détecter des **signatures de fichiers spécifiques** ou des **comportements suspects**.

#### Fonctionnalités principales

> Syntaxe simple et flexible

> Peut scanner des **fichiers**, la **mémoire vive**, et le **trafic réseau**

#### Pourquoi utiliser YARA pour la détection de malwares ?

> **Détection de malwares** : Basée sur des motifs connus, chaînes de caractères ou comportements.

> **Threat Hunting** : Recherche proactive de menaces nouvelles ou dissimulées.

> **Scalabilité** : Fonctionne sur de grandes quantités de données et divers environnements.

> **Cas d’usage** :

- Détection de ransomwares, chevaux de Troie, malwares obfusqués

- Identification de communications avec des serveurs de commande et contrôle (C2)

#### Comprendre la structure d’une règle YARA

> Les règles YARA sont structurées en plusieurs sections principales :

#### Composants clés d’une règle YARA

```sh
rule Nom_De_La_Règle {
  meta:
    author = "Nom de l'auteur"
    description = "Brève description de la règle"
    date = "YYYY-MM-DD"
    version = "1.0"

  strings:
    $string1 = "texte à détecter"
    $hex1 = {6A 40 68}
    $regex1 = /[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}/

  condition:
    any of them
}
```

#### Exemple complet de règle YARA

```sh
rule Sample_Malware_Detection {
  meta:
    author = "Your Name"
    description = "Cette règle détecte un échantillon de malware spécifique via ses motifs textuels et hexadécimaux."
    date = "2025-03-21"
    version = "1.0"
    reference = "https://malware-analysis-example.com"
    malware_family = "SampleMalware"

  strings:
    $text_string1 = "malicious_function"
    $hex_pattern1 = {6A 40 68 00 30 00 00 6A 14}
    $regex_pattern1 = /[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}/
    $url = "http://malicious-website.com"

  condition:
    any of them
}
```

```sh
--------Linux----------

md5sum fichier_malveillant.exe
sha1sum fichier_malveillant.exe
sha256sum fichier_malveillant.exe

---------Windows---------

md5sum eicar_com.zip
sha1sum eicar_com.zip

CertUtil -hashfile fichier_malveillant.exe MD5
CertUtil -hashfile fichier_malveillant.exe SHA1
CertUtil -hashfile fichier_malveillant.exe SHA256
```

#### Autres ressources

- [https://mh-nexus.de/en/hxd/](https://mh-nexus.de/en/hxd/)
- [https://www.eicar.org/download-anti-malware-testfile/#top](https://www.eicar.org/download-anti-malware-testfile/#top)
- [https://hashtab.en.softonic.com/](https://hashtab.en.softonic.com/)
- [https://www.virustotal.com/](https://www.virustotal.com/)
- [https://bazaar.abuse.ch/](https://bazaar.abuse.ch/)
- [https://www.hybrid-analysis.com/](https://www.hybrid-analysis.com/)
