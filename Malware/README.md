# YARA 

- YARA is a powerfull tool used to detect and classify malware by defining patterns.
- YARA (Yet Another Recursive Acronym) is a rule-based language used for identifying and classifying malware samples based on patterns.
- Purpose: Helps in threat hunting, malware analysis, and incident resposne by detecting specific file signatures and behavioral patterns.
- Key Features:
  - Simple and flexible syntax
  - Can scan files, memory, and network traffic.

# Why use YARA for Malware detection ?

- Malware Detection: Identifies malware based on known patterns, strings, and behaviors.
- Threat Hunting: Enables proactive searches for new and emerging threats.
- Scalability: Works across various platforms, handling large datasets.
- Use Cases:
  - Detecting ransomware, trojans, and obfuscated malware.
  - Identifying command-and-control traffic.

# Understanding the YARA Rule Structure

- YARA rules are structured using defined sections to detect patterns in malware.

# Key Components of a YARA Rule

```sh
rule Rule_Name {...}

# -----------

meta:
  author = "Author Name"
  description = "Brief description of what the rule does"
  date = "YYY-MM-DD"
  version = "1.0"

# -----------

strings:
  $string1 = "text to macth"
  $hex1 = {6A 40 68}
  $regex1 = /[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}/

# ---------

condition:
  any of them // or other conditions like all of them, $string1 and $hex1, etc.
```

# Structure

```sh
rule Sample_Malware_Detection {

// Metadata section contains information about the rule
meta:
   author = "Your Name"
   description = "This rule detects a specific
                  sample malware based on its strings and hex patterns."
   date: "2025-03-21"
   version: "1.0"
   reference: "https://malware-analysis-example.com"
   malware_family = "SampleMalware"

// Strings section contains patterns (text, hex, or regex) to search for
strings:
   $text_string1 = "malicious_function"  // Specific malicious function name in text
   $hex_pattern1 = {6A 40 68 00 30 00 00 6A 14}  // A known hex pattern used in the malware
   $regex_pattern1 = /[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}/

// Regex pattern to detect email addresses
   $url = "http://malicous-website.com"  // URL often seen in malware communications

// Condition section defines the logic for when the rule should trigger
condition:
  // The rule triggers if any of the strings are found in the file
   any of them
}
```
