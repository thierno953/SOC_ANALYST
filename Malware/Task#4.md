# Détection de code malveillant obfusqué

- Détecter des **techniques d’obfuscation simples** utilisées dans les malwares, telles que :

  - **Anti-debug** (`C3 CC CC CC`)

  - **Obfuscation de flux de contrôle** (`EB 05 90`)

  - **Utilisation d'API mémoire suspectes** (`VirtualAlloc`)

  - **Chaînes codées ou masquées** (`HiddenData`)

```sh 
nano task4.yar
```

```sh
rule Simple_Obfuscated_Malware {
  meta:
    description = "Detects basic obfuscation techniques in malware"
    author = "Security Team"
    date = "2025-01-05"
    severity = "high"
    reference = "https://example.com"

  strings:
    $anti_debug_pattern = { C3 CC CC CC }
    $control_flow_obfuscation = { EB 05 90 }
    $api_virtualalloc = "VirtualAlloc"
    $encoded_string = "HiddenData" ascii wide nocase

  condition:
    ($anti_debug_pattern and $control_flow_obfuscation) or ($api_virtualalloc and $encoded_string)
}
```

```sh
nano file4.txt
```

```sh
--- BEGIN FILE HEADER ---
File ID: SIMPLE-MALWARE-2025
Timestamp: 2025-01-14T14:30:00Z
Threat Level: HIGH
Malware Type: Obfuscated Sample

--- SYSTEM INFORMATION ---
Operating System: Windows 10
User: SYSTEM

--- CODE SECTION ---
0x00401000: C3
0x00401001: CC CC CC
0x00401004: 90
0x00401005: EB 05
0x00401007: 90 90

--- MEMORY ALLOCATION ---
0x00402000: CALL VirtualAlloc ; Allocate memory for future code injection

--- HIDDEN STRINGS ---
Encode String: HiddenData (placeholder for sensitive data)

--- NETWORK CONNECTION ---
IP Address: 192.168.1.0
Port: 8080

--- FILE FOOTER ---
Checksum: SHA-256: D3F8+6E
Verification: Non-malicious educational file (used for demonstration purposes)
```

```sh
yara task4.yar file4.txt
yara -s task4.yar file4.txt
```
